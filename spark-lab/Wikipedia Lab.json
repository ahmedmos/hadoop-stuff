{"paragraphs":[{"text":"%md\n# Wikipedia LAB\nThis lab will walk you through Spark ETL, SQL, Graph and ML APIs","dateUpdated":"2016-12-18T07:05:14+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482087252611_-1723631751","id":"20161218-185412_3043831","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Wikipedia LAB</h1>\n<p>This lab will walk you through Spark ETL, SQL, Graph and ML APIs</p>\n"},"dateCreated":"2016-12-18T06:54:12+0000","dateStarted":"2016-12-18T07:05:14+0000","dateFinished":"2016-12-18T07:05:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26486"},{"text":"%md\n### We need first to import spark-csv package into Zeppelin notebook as we will use it later","dateUpdated":"2016-12-19T10:32:31+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482143527826_-1947913287","id":"20161219-103207_461799857","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>We need first to import spark-csv package into Zeppelin notebook as we will use it later</h3>\n"},"dateCreated":"2016-12-19T10:32:07+0000","dateStarted":"2016-12-19T10:32:32+0000","dateFinished":"2016-12-19T10:32:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26487"},{"text":"%dep\nz.reset()\nz.addRepo(\"Spark Packages Repo\").url(\"http://dl.bintray.com/spark-packages/maven\")\nz.load(\"com.databricks:spark-csv_2.10:1.5.0\")","dateUpdated":"2016-12-19T10:32:34+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482143523520_641077386","id":"20161219-103203_79318689","result":{"code":"SUCCESS","type":"TEXT","msg":"DepInterpreter(%dep) deprecated. Remove dependencies and repositories through GUI interpreter menu instead.\nDepInterpreter(%dep) deprecated. Add repository through GUI interpreter menu instead.\nDepInterpreter(%dep) deprecated. Load dependency through GUI interpreter menu instead.\nres0: org.apache.zeppelin.dep.Dependency = org.apache.zeppelin.dep.Dependency@7835aff0\n"},"dateCreated":"2016-12-19T10:32:03+0000","dateStarted":"2016-12-19T10:32:34+0000","dateFinished":"2016-12-19T10:33:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26488"},{"text":"//some decalarations\nimport org.apache.spark.sql.{DataFrame, SQLContext}\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nval sqlContext = new SQLContext(sc)\nimport sqlContext.implicits._\n","dateUpdated":"2016-12-19T10:33:13+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482087339576_20959324","id":"20161218-185539_1214949734","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.sql.{DataFrame, SQLContext}\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nsqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@1ab8a33b\nimport sqlContext.implicits._\n"},"dateCreated":"2016-12-18T06:55:39+0000","dateStarted":"2016-12-19T10:33:13+0000","dateFinished":"2016-12-19T10:34:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26489"},{"text":"//declare data files locations\nval PARQUET_DATA = \"hdfs:///wikipedia_pagecounts_single/pagecounts-20160801-000000.parquet\"\nval PAGEVIEWS_PER_SECOND = \"hdfs:///wikipedia_pagecounts_single/pageviews-by-second-tsv.gz\"\nval CLICKSTREAMS_DATA = \"hdfs:///wikipedia_pagecounts_single/clickstreams/\"","dateUpdated":"2016-12-19T10:34:23+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482142377150_980566599","id":"20161219-101257_198677645","result":{"code":"SUCCESS","type":"TEXT","msg":"PARQUET_DATA: String = hdfs:///wikipedia_pagecounts_single/pagecounts-20160801-000000.parquet\nPAGEVIEWS_PER_SECOND: String = hdfs:///wikipedia_pagecounts_single/pageviews-by-second-tsv.gz\nCLICKSTREAMS_DATA: String = hdfs:///wikipedia_pagecounts_single/clickstreams/\n"},"dateCreated":"2016-12-19T10:12:57+0000","dateStarted":"2016-12-19T10:34:23+0000","dateFinished":"2016-12-19T10:34:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26490"},{"text":"//declare a parquet data loading method\ndef loadParquetData(path: String): DataFrame = {\n\t\tval data = sqlContext.read.parquet(path)\n\t\tdata\n}","dateUpdated":"2016-12-19T10:53:58+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482142611928_1472582177","id":"20161219-101651_1469798852","result":{"code":"SUCCESS","type":"TEXT","msg":"loadParquetData: (path: String)org.apache.spark.sql.DataFrame\n"},"dateCreated":"2016-12-19T10:16:51+0000","dateStarted":"2016-12-19T10:53:58+0000","dateFinished":"2016-12-19T10:53:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26491"},{"text":"%md\n# Some ETL and SQL playing with Wikipedia data\n","dateUpdated":"2016-12-19T10:19:15+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482142724624_1266542301","id":"20161219-101844_1233630088","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Some ETL and SQL playing with Wikipedia data</h1>\n"},"dateCreated":"2016-12-19T10:18:44+0000","dateStarted":"2016-12-19T10:19:15+0000","dateFinished":"2016-12-19T10:19:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26492"},{"text":"%md\n## Show subset of the data","dateUpdated":"2016-12-19T10:20:15+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482142755613_849520466","id":"20161219-101915_2036965751","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Show subset of the data</h2>\n"},"dateCreated":"2016-12-19T10:19:15+0000","dateStarted":"2016-12-19T10:20:15+0000","dateFinished":"2016-12-19T10:20:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26493"},{"text":"\nval parquetData = loadParquetData(PARQUET_DATA)\nparquetData.show(10, truncate = false)","dateUpdated":"2016-12-19T10:54:03+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482142803594_1212951646","id":"20161219-102003_945007537","result":{"code":"SUCCESS","type":"TEXT","msg":"parquetData: org.apache.spark.sql.DataFrame = [project: string, item: string, requests: double]\n+-------+----------------------------+--------+\n|project|item                        |requests|\n+-------+----------------------------+--------+\n|en     |                            |577.0   |\n|en     |!!                          |2.0     |\n|en     |!!!                         |3.0     |\n|en     |!!!Fuck_You!!!              |2.0     |\n|en     |!!!Fuck_You!!!_And_Then_Some|1.0     |\n|en     |!!!Fuck_You!!!_and_Then_Some|2.0     |\n|en     |!%3F                        |1.0     |\n|en     |!@                          |1.0     |\n|en     |!Alla_tu!                   |1.0     |\n|en     |!Arriba!_La_Pachanga        |1.0     |\n+-------+----------------------------+--------+\nonly showing top 10 rows\n\n"},"dateCreated":"2016-12-19T10:20:03+0000","dateStarted":"2016-12-19T10:54:03+0000","dateFinished":"2016-12-19T10:54:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26494"},{"text":"parquetData.printSchema()\n","dateUpdated":"2016-12-19T10:21:21+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482142820616_631611382","id":"20161219-102020_47859283","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- project: string (nullable = true)\n |-- item: string (nullable = true)\n |-- requests: double (nullable = true)\n\n"},"dateCreated":"2016-12-19T10:20:20+0000","dateStarted":"2016-12-19T10:21:21+0000","dateFinished":"2016-12-19T10:21:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26495"},{"text":"%md\n## How many rows in the dataset?","dateUpdated":"2016-12-19T10:22:06+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482142915011_-294724407","id":"20161219-102155_1697965038","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>How many rows in the dataset?</h2>\n"},"dateCreated":"2016-12-19T10:21:55+0000","dateStarted":"2016-12-19T10:22:06+0000","dateFinished":"2016-12-19T10:22:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26496"},{"text":"parquetData.count()","dateUpdated":"2016-12-19T10:21:45+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482142854274_-640121650","id":"20161219-102054_1492605385","result":{"code":"SUCCESS","type":"TEXT","msg":"res13: Long = 2490282\n"},"dateCreated":"2016-12-19T10:20:54+0000","dateStarted":"2016-12-19T10:21:45+0000","dateFinished":"2016-12-19T10:21:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26497"},{"text":"%md\n##Order data by request","dateUpdated":"2016-12-19T10:22:29+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482142905613_-1539988031","id":"20161219-102145_1955945219","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Order data by request</h2>\n"},"dateCreated":"2016-12-19T10:21:45+0000","dateStarted":"2016-12-19T10:22:29+0000","dateFinished":"2016-12-19T10:22:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26498"},{"text":"parquetData.orderBy($\"requests\".desc).show(20, truncate = false)\n","dateUpdated":"2016-12-19T10:22:35+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482142945144_2051920431","id":"20161219-102225_104136897","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------+-----------------------------------------------+---------+\n|project|item                                           |requests |\n+-------+-----------------------------------------------+---------+\n|en.mw  |en                                             |5336925.0|\n|en     |Main_Page                                      |1225357.0|\n|en     |Antoninus_Pius                                 |36462.0  |\n|en     |Special:Search                                 |20940.0  |\n|en     |Okto                                           |9495.0   |\n|en     |Liberian_general_election,_1927                |9309.0   |\n|en     |Proyecto_40                                    |9282.0   |\n|en     |Jimmy_Walker_(golfer)                          |8144.0   |\n|en     |Harry_Potter_and_the_Cursed_Child              |5536.0   |\n|en     |RAS_syndrome                                   |5267.0   |\n|en     |Wikipedia:Contact_us                           |3928.0   |\n|en     |List_of_feed_aggregators                       |3884.0   |\n|en     |Jason_Day                                      |3721.0   |\n|en     |Stranger_Things_(TV_series)                    |3457.0   |\n|en     |Dating                                         |3225.0   |\n|en     |File:Donald_Trump_August_19,_2015_(cropped).jpg|2923.0   |\n|en     |Special:Watchlist                              |2768.0   |\n|en     |Lali_Esp%C3%B3sito                             |2549.0   |\n|en     |Donald_Trump                                   |2386.0   |\n|en     |Deaths_in_2016                                 |2379.0   |\n+-------+-----------------------------------------------+---------+\nonly showing top 20 rows\n\n"},"dateCreated":"2016-12-19T10:22:25+0000","dateStarted":"2016-12-19T10:22:35+0000","dateFinished":"2016-12-19T10:22:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26499"},{"text":"%md\n## NOTICE how we access the data using the notation: $\"column'..\n\n## NOTICE ALSO how we can run implicit functions on the column such as $\"column\" ..\n### This is because we imported the Spark SQL Context implicit functions; if not we would have needed to run it like this: desc($\"column\") which is less readable","dateUpdated":"2016-12-19T10:38:37+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482143757854_557692500","id":"20161219-103557_1740574099","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>NOTICE how we access the data using the notation: $&ldquo;column'..</h2>\n<h2>NOTICE ALSO how we can run implicit functions on the column such as $&ldquo;column&rdquo; ..</h2>\n<h3>This is because we imported the Spark SQL Context implicit functions; if not we would have needed to run it like this: desc($&ldquo;column&rdquo;) which is less readable</h3>\n"},"dateCreated":"2016-12-19T10:35:57+0000","dateStarted":"2016-12-19T10:38:37+0000","dateFinished":"2016-12-19T10:38:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26500"},{"text":"%md\n## What are the available projects in Wikipedia? ","dateUpdated":"2016-12-19T10:23:14+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482142955622_964620039","id":"20161219-102235_1367680126","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>What are the available projects in Wikipedia?</h2>\n"},"dateCreated":"2016-12-19T10:22:35+0000","dateStarted":"2016-12-19T10:23:14+0000","dateFinished":"2016-12-19T10:23:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26501"},{"text":"parquetData.select($\"project\").distinct().show()\n","dateUpdated":"2016-12-19T10:23:20+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482142994882_649003348","id":"20161219-102314_311052494","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------+\n|project|\n+-------+\n|   en.b|\n|   en.d|\n|   en.n|\n|   en.q|\n|   en.s|\n|   en.v|\n|  en.mw|\n| en.voy|\n|     en|\n+-------+\n\n"},"dateCreated":"2016-12-19T10:23:14+0000","dateStarted":"2016-12-19T10:23:20+0000","dateFinished":"2016-12-19T10:23:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26502"},{"text":"%md\n## How much traffic did each project get?","dateUpdated":"2016-12-19T10:23:40+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482143000591_876020523","id":"20161219-102320_1080798367","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>How much traffic did each project get?</h2>\n"},"dateCreated":"2016-12-19T10:23:20+0000","dateStarted":"2016-12-19T10:23:40+0000","dateFinished":"2016-12-19T10:23:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26503"},{"text":"\t\tparquetData.select($\"project\", $\"requests\").groupBy($\"project\").sum().orderBy($\"sum(requests)\".desc).show()\n","dateUpdated":"2016-12-19T10:23:42+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482143020153_-768765701","id":"20161219-102340_321345217","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------+-------------+\n|project|sum(requests)|\n+-------+-------------+\n|     en|    6949620.0|\n|  en.mw|    5336925.0|\n|   en.d|     157174.0|\n|   en.s|      18577.0|\n|   en.q|      17970.0|\n|   en.b|      14440.0|\n|   en.v|       5565.0|\n| en.voy|       5050.0|\n|   en.n|       3582.0|\n+-------+-------------+\n\n"},"dateCreated":"2016-12-19T10:23:40+0000","dateStarted":"2016-12-19T10:23:42+0000","dateFinished":"2016-12-19T10:23:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26504"},{"text":"%md\n## Select only English Wikipedia to play with\n","dateUpdated":"2016-12-19T10:24:06+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482143022671_-172404905","id":"20161219-102342_1757366838","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Select only English Wikipedia to play with</h2>\n"},"dateCreated":"2016-12-19T10:23:42+0000","dateStarted":"2016-12-19T10:24:06+0000","dateFinished":"2016-12-19T10:24:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26505"},{"text":"\t\tval pagecountsEnWikipediaDF = parquetData.filter($\"project\" === \"en\")\n","dateUpdated":"2016-12-19T10:54:30+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482143046835_-1734303194","id":"20161219-102406_807046980","result":{"code":"SUCCESS","type":"TEXT","msg":"pagecountsEnWikipediaDF: org.apache.spark.sql.DataFrame = [project: string, item: string, requests: double]\n"},"dateCreated":"2016-12-19T10:24:06+0000","dateStarted":"2016-12-19T10:54:30+0000","dateFinished":"2016-12-19T10:54:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26506"},{"text":"%md\n## What are the 25 most popular articles in English Wikipedia? ","dateUpdated":"2016-12-19T10:24:41+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482143049340_1064006205","id":"20161219-102409_1218689819","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>What are the 25 most popular articles in English Wikipedia?</h2>\n"},"dateCreated":"2016-12-19T10:24:09+0000","dateStarted":"2016-12-19T10:24:41+0000","dateFinished":"2016-12-19T10:24:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26507"},{"text":"\t\tpagecountsEnWikipediaDF.orderBy($\"requests\".desc).show(25, truncate = false)\n","dateUpdated":"2016-12-19T10:24:43+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482143076755_-1740028455","id":"20161219-102436_1814022089","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------+-----------------------------------------------+---------+\n|project|item                                           |requests |\n+-------+-----------------------------------------------+---------+\n|en     |Main_Page                                      |1225357.0|\n|en     |Antoninus_Pius                                 |36462.0  |\n|en     |Special:Search                                 |20940.0  |\n|en     |Okto                                           |9495.0   |\n|en     |Liberian_general_election,_1927                |9309.0   |\n|en     |Proyecto_40                                    |9282.0   |\n|en     |Jimmy_Walker_(golfer)                          |8144.0   |\n|en     |Harry_Potter_and_the_Cursed_Child              |5536.0   |\n|en     |RAS_syndrome                                   |5267.0   |\n|en     |Wikipedia:Contact_us                           |3928.0   |\n|en     |List_of_feed_aggregators                       |3884.0   |\n|en     |Jason_Day                                      |3721.0   |\n|en     |Stranger_Things_(TV_series)                    |3457.0   |\n|en     |Dating                                         |3225.0   |\n|en     |File:Donald_Trump_August_19,_2015_(cropped).jpg|2923.0   |\n|en     |Special:Watchlist                              |2768.0   |\n|en     |Lali_Esp%C3%B3sito                             |2549.0   |\n|en     |Donald_Trump                                   |2386.0   |\n|en     |Deaths_in_2016                                 |2379.0   |\n|en     |Suicide_Squad_(film)                           |2154.0   |\n|en     |Jason_Bourne_(film)                            |1950.0   |\n|en     |Killing_of_Tim_McLean                          |1916.0   |\n|en     |2016_Summer_Olympics                           |1895.0   |\n|en     |Ddd                                            |1799.0   |\n|en     |Elon_Musk                                      |1752.0   |\n+-------+-----------------------------------------------+---------+\nonly showing top 25 rows\n\n"},"dateCreated":"2016-12-19T10:24:36+0000","dateStarted":"2016-12-19T10:24:43+0000","dateFinished":"2016-12-19T10:24:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26508"},{"text":"%md\n## The data needs to be cleaned from Wikipedia namespaces; they have different forms such as SOME:THING\n\nWe will use regular expressions for this","dateUpdated":"2016-12-19T10:26:27+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482143083821_-1851975061","id":"20161219-102443_792913509","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>The data needs to be cleaned from Wikipedia namespaces; they have different forms such as SOME:THING</h2>\n<p>We will use regular expressions for this</p>\n"},"dateCreated":"2016-12-19T10:24:43+0000","dateStarted":"2016-12-19T10:26:27+0000","dateFinished":"2016-12-19T10:26:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26509"},{"text":"val pagecountsEnWikipediaArticlesOnlyDF = pagecountsEnWikipediaDF\n\t\t                                          .filter($\"item\".rlike(\"\"\"^((?!Special:)+)\"\"\"))\n\t\t                                          .filter($\"item\".rlike(\"\"\"^((?!File:)+)\"\"\"))\n\t\t                                          .filter($\"item\".rlike(\"\"\"^((?!Category:)+)\"\"\"))\n\t\t                                          .filter($\"item\".rlike(\"\"\"^((?!User:)+)\"\"\"))\n\t\t                                          .filter($\"item\".rlike(\"\"\"^((?!Talk:)+)\"\"\"))\n\t\t                                          .filter($\"item\".rlike(\"\"\"^((?!Template:)+)\"\"\"))\n\t\t                                          .filter($\"item\".rlike(\"\"\"^((?!Help:)+)\"\"\"))\n\t\t                                          .filter($\"item\".rlike(\"\"\"^((?!Wikipedia:)+)\"\"\"))\n\t\t                                          .filter($\"item\".rlike(\"\"\"^((?!MediaWiki:)+)\"\"\"))\n\t\t                                          .filter($\"item\".rlike(\"\"\"^((?!Portal:)+)\"\"\"))\n\t\t                                          .filter($\"item\".rlike(\"\"\"^((?!Book:)+)\"\"\"))\n\t\t                                          .filter($\"item\".rlike(\"\"\"^((?!Draft:)+)\"\"\"))\n\t\t                                          .filter($\"item\".rlike(\"\"\"^((?!Education_Program:)+)\"\"\"))\n\t\t                                          .filter($\"item\".rlike(\"\"\"^((?!TimedText:)+)\"\"\"))\n\t\t                                          .filter($\"item\".rlike(\"\"\"^((?!Module:)+)\"\"\"))\n\t\t                                          .filter($\"item\".rlike(\"\"\"^((?!Topic:)+)\"\"\"))\n\t\t                                          .filter($\"item\".rlike(\"\"\"^((?!Images/)+)\"\"\"))\n\t\t                                          .filter($\"item\".rlike(\"\"\"^((?!%22//upload.wikimedia.org)+)\"\"\"))\n\t\t                                          .filter($\"item\".rlike(\"\"\"^((?!%22//en.wikipedia.org)+)\"\"\"))\npagecountsEnWikipediaArticlesOnlyDF.orderBy($\"requests\".desc).show(25, truncate = false)","dateUpdated":"2016-12-19T10:54:40+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482143146072_1391381546","id":"20161219-102546_1804398871","result":{"code":"SUCCESS","type":"TEXT","msg":"pagecountsEnWikipediaArticlesOnlyDF: org.apache.spark.sql.DataFrame = [project: string, item: string, requests: double]\n+-------+---------------------------------+---------+\n|project|item                             |requests |\n+-------+---------------------------------+---------+\n|en     |Main_Page                        |1225357.0|\n|en     |Antoninus_Pius                   |36462.0  |\n|en     |Okto                             |9495.0   |\n|en     |Liberian_general_election,_1927  |9309.0   |\n|en     |Proyecto_40                      |9282.0   |\n|en     |Jimmy_Walker_(golfer)            |8144.0   |\n|en     |Harry_Potter_and_the_Cursed_Child|5536.0   |\n|en     |RAS_syndrome                     |5267.0   |\n|en     |List_of_feed_aggregators         |3884.0   |\n|en     |Jason_Day                        |3721.0   |\n|en     |Stranger_Things_(TV_series)      |3457.0   |\n|en     |Dating                           |3225.0   |\n|en     |Lali_Esp%C3%B3sito               |2549.0   |\n|en     |Donald_Trump                     |2386.0   |\n|en     |Deaths_in_2016                   |2379.0   |\n|en     |Suicide_Squad_(film)             |2154.0   |\n|en     |Jason_Bourne_(film)              |1950.0   |\n|en     |Killing_of_Tim_McLean            |1916.0   |\n|en     |2016_Summer_Olympics             |1895.0   |\n|en     |Ddd                              |1799.0   |\n|en     |Elon_Musk                        |1752.0   |\n|en     |Bourne_(film_series)             |1619.0   |\n|en     |Earth                            |1503.0   |\n|en     |Kevin_Bacon                      |1492.0   |\n|en     |Star_Trek_Beyond                 |1468.0   |\n+-------+---------------------------------+---------+\nonly showing top 25 rows\n\n"},"dateCreated":"2016-12-19T10:25:46+0000","dateStarted":"2016-12-19T10:54:40+0000","dateFinished":"2016-12-19T10:55:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26510"},{"text":"%md\n## Now, let's play with some SQL constructs in Spark.\n\n### Let's build a Struct type for the new data we will import","dateUpdated":"2016-12-19T10:27:43+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482143193521_-66185205","id":"20161219-102633_1446930660","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Now, let's play with some SQL constructs in Spark.</h2>\n<h3>Let's build a Struct type for the new data we will import</h3>\n"},"dateCreated":"2016-12-19T10:26:33+0000","dateStarted":"2016-12-19T10:27:43+0000","dateFinished":"2016-12-19T10:27:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26511"},{"text":"val schema = StructType(\n\t\t\t                       List(\n\t\t\t\t                           StructField(\"timestamp\", StringType, true),\n\t\t\t\t                           StructField(\"site\", StringType, true),\n\t\t\t\t                           StructField(\"requests\", IntegerType, true)\n\t\t\t                           )\n\t\t                       )","dateUpdated":"2016-12-19T10:34:41+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482143235420_894594095","id":"20161219-102715_2113615790","result":{"code":"SUCCESS","type":"TEXT","msg":"schema: org.apache.spark.sql.types.StructType = StructType(StructField(timestamp,StringType,true), StructField(site,StringType,true), StructField(requests,IntegerType,true))\n"},"dateCreated":"2016-12-19T10:27:15+0000","dateStarted":"2016-12-19T10:34:41+0000","dateFinished":"2016-12-19T10:34:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26512"},{"text":"val df = sqlContext.read\n\t\t         .format(\"com.databricks.spark.csv\")\n\t\t         .option(\"delimiter\", \"\\t\")\n\t\t         .option(\"header\", \"true\")\n\t\t         .schema(schema)\n\t\t         .load(PAGEVIEWS_PER_SECOND)\n\t\t         .select($\"site\", $\"requests\",\n\t\t                 (\n\t\t\t                 unix_timestamp($\"timestamp\", \"yyyy-MM-dd'T'HH:mm:ss\")\n\t\t\t                 ).cast(\"timestamp\").as(\"timestamp\"))\ndf.show(truncate = false)","dateUpdated":"2016-12-19T10:34:45+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482143266889_352729726","id":"20161219-102746_1034960621","result":{"code":"SUCCESS","type":"TEXT","msg":"df: org.apache.spark.sql.DataFrame = [site: string, requests: int, timestamp: timestamp]\n+-------+--------+---------------------+\n|site   |requests|timestamp            |\n+-------+--------+---------------------+\n|mobile |1595    |2015-03-16 00:09:55.0|\n|mobile |1544    |2015-03-16 00:10:39.0|\n|desktop|2460    |2015-03-16 00:19:39.0|\n|desktop|2237    |2015-03-16 00:38:11.0|\n|mobile |1656    |2015-03-16 00:42:40.0|\n|desktop|2452    |2015-03-16 00:52:24.0|\n|mobile |1654    |2015-03-16 00:54:16.0|\n|mobile |1720    |2015-03-16 01:18:11.0|\n|desktop|2288    |2015-03-16 01:30:32.0|\n|mobile |1609    |2015-03-16 01:32:24.0|\n|desktop|2341    |2015-03-16 01:42:08.0|\n|mobile |1704    |2015-03-16 01:45:53.0|\n|desktop|2554    |2015-03-16 01:55:37.0|\n|mobile |1825    |2015-03-16 01:57:29.0|\n|desktop|2492    |2015-03-16 02:03:16.0|\n|mobile |1667    |2015-03-16 02:10:32.0|\n|desktop|2452    |2015-03-16 02:16:45.0|\n|desktop|2412    |2015-03-16 02:19:32.0|\n|desktop|2350    |2015-03-16 02:20:16.0|\n|mobile |1802    |2015-03-16 02:22:08.0|\n+-------+--------+---------------------+\nonly showing top 20 rows\n\n"},"dateCreated":"2016-12-19T10:27:46+0000","dateStarted":"2016-12-19T10:34:45+0000","dateFinished":"2016-12-19T10:34:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26513"},{"text":"%md\n## Reorder the data by timestamp then site","dateUpdated":"2016-12-19T10:35:17+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482143295038_1988358597","id":"20161219-102815_1278651751","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Reorder the data by timestamp then site</h2>\n"},"dateCreated":"2016-12-19T10:28:15+0000","dateStarted":"2016-12-19T10:35:17+0000","dateFinished":"2016-12-19T10:35:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26514"},{"text":"val pageviewsDF = df.orderBy($\"timestamp\", $\"site\".desc)\n","dateUpdated":"2016-12-19T10:35:25+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482143717921_304081678","id":"20161219-103517_1195381879","result":{"code":"SUCCESS","type":"TEXT","msg":"pageviewsDF: org.apache.spark.sql.DataFrame = [site: string, requests: int, timestamp: timestamp]\n"},"dateCreated":"2016-12-19T10:35:17+0000","dateStarted":"2016-12-19T10:35:25+0000","dateFinished":"2016-12-19T10:35:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26515"},{"text":"%md\n## register the data as a temporary table","dateUpdated":"2016-12-19T10:39:14+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482143725740_1689193042","id":"20161219-103525_582033254","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>register the data as a temporary table</h2>\n"},"dateCreated":"2016-12-19T10:35:25+0000","dateStarted":"2016-12-19T10:39:14+0000","dateFinished":"2016-12-19T10:39:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26516"},{"text":"\t\tpageviewsDF.registerTempTable(\"pageviews_by_second_ordered\")\n\t\tsqlContext.cacheTable(\"pageviews_by_second_ordered\")\n\n","dateUpdated":"2016-12-19T10:39:34+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482143954218_-684217298","id":"20161219-103914_1210461751","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2016-12-19T10:39:14+0000","dateStarted":"2016-12-19T10:39:35+0000","dateFinished":"2016-12-19T10:40:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26517"},{"text":"pageviewsDF.count","dateUpdated":"2016-12-19T10:43:55+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482143957869_-2057169939","id":"20161219-103917_375268496","result":{"code":"SUCCESS","type":"TEXT","msg":"res13: Long = 7200000\n"},"dateCreated":"2016-12-19T10:39:17+0000","dateStarted":"2016-12-19T10:43:55+0000","dateFinished":"2016-12-19T10:45:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26518"},{"text":"%md \n### How many total requests on mobile vs desktop?\n","dateUpdated":"2016-12-19T10:44:30+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144042744_26953556","id":"20161219-104042_1693768050","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>How many total requests on mobile vs desktop?</h3>\n"},"dateCreated":"2016-12-19T10:40:42+0000","dateStarted":"2016-12-19T10:44:30+0000","dateFinished":"2016-12-19T10:44:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26519"},{"text":"\t\tpageviewsDF.filter($\"site\" === \"mobile\").select(sum($\"requests\")).show\n","dateUpdated":"2016-12-19T10:44:45+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144270077_-2005954007","id":"20161219-104430_2075347539","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------------+\n|sum(requests)|\n+-------------+\n|   4605797962|\n+-------------+\n\n"},"dateCreated":"2016-12-19T10:44:30+0000","dateStarted":"2016-12-19T10:44:45+0000","dateFinished":"2016-12-19T10:46:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26520"},{"text":"\t\tpageviewsDF.filter($\"site\" === \"desktop\").select(sum($\"requests\")).show\n","dateUpdated":"2016-12-19T10:44:51+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144285767_-671798063","id":"20161219-104445_633886574","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------------+\n|sum(requests)|\n+-------------+\n|   8737180972|\n+-------------+\n\n"},"dateCreated":"2016-12-19T10:44:45+0000","dateStarted":"2016-12-19T10:45:55+0000","dateFinished":"2016-12-19T10:46:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26521"},{"text":"%md\n### Change timestamp column from String to timestamp datatype ","dateUpdated":"2016-12-19T10:45:52+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144291956_1685558447","id":"20161219-104451_2065828085","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Change timestamp column from String to timestamp datatype</h3>\n"},"dateCreated":"2016-12-19T10:44:51+0000","dateStarted":"2016-12-19T10:45:52+0000","dateFinished":"2016-12-19T10:45:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26522"},{"text":"val pageviewsTimestampDF = pageviewsDF.select($\"timestamp\".cast(\"timestamp\"), $\"site\", $\"requests\")\n\t\tpageviewsTimestampDF.printSchema()\n\t\tpageviewsTimestampDF.show(10, truncate = false)","dateUpdated":"2016-12-19T10:46:09+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144352263_-452820100","id":"20161219-104552_1420362037","result":{"code":"SUCCESS","type":"TEXT","msg":"pageviewsTimestampDF: org.apache.spark.sql.DataFrame = [timestamp: timestamp, site: string, requests: int]\nroot\n |-- timestamp: timestamp (nullable = true)\n |-- site: string (nullable = true)\n |-- requests: integer (nullable = true)\n\n+---------------------+-------+--------+\n|timestamp            |site   |requests|\n+---------------------+-------+--------+\n|2015-03-16 00:00:00.0|mobile |1628    |\n|2015-03-16 00:00:00.0|desktop|2343    |\n|2015-03-16 00:00:01.0|mobile |1636    |\n|2015-03-16 00:00:01.0|desktop|2382    |\n|2015-03-16 00:00:02.0|mobile |1619    |\n|2015-03-16 00:00:02.0|desktop|2546    |\n|2015-03-16 00:00:03.0|mobile |1776    |\n|2015-03-16 00:00:03.0|desktop|2402    |\n|2015-03-16 00:00:04.0|mobile |1716    |\n|2015-03-16 00:00:04.0|desktop|2370    |\n+---------------------+-------+--------+\nonly showing top 10 rows\n\n"},"dateCreated":"2016-12-19T10:45:52+0000","dateStarted":"2016-12-19T10:46:09+0000","dateFinished":"2016-12-19T10:46:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26523"},{"text":"%md\n## Using SQL API now you can use timestamp specific functions","dateUpdated":"2016-12-19T10:46:39+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144369330_1681412697","id":"20161219-104609_942054424","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Using SQL API now you can use timestamp specific functions</h2>\n"},"dateCreated":"2016-12-19T10:46:09+0000","dateStarted":"2016-12-19T10:46:39+0000","dateFinished":"2016-12-19T10:46:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26524"},{"text":"\t\tpageviewsTimestampDF.select(year($\"timestamp\")).distinct().show()\n","dateUpdated":"2016-12-19T10:46:48+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144399004_2004632422","id":"20161219-104639_527234262","result":{"code":"SUCCESS","type":"TEXT","msg":"+---------------+\n|year(timestamp)|\n+---------------+\n|           2015|\n+---------------+\n\n"},"dateCreated":"2016-12-19T10:46:39+0000","dateStarted":"2016-12-19T10:46:49+0000","dateFinished":"2016-12-19T10:47:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26525"},{"text":"\t\tpageviewsTimestampDF.select(weekofyear($\"timestamp\")).distinct().show()\n","dateUpdated":"2016-12-19T10:46:54+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144408959_2136631943","id":"20161219-104648_373775032","result":{"code":"SUCCESS","type":"TEXT","msg":"+---------------------+\n|weekofyear(timestamp)|\n+---------------------+\n|                   12|\n|                   13|\n|                   14|\n|                   15|\n|                   16|\n|                   17|\n+---------------------+\n\n"},"dateCreated":"2016-12-19T10:46:48+0000","dateStarted":"2016-12-19T10:46:54+0000","dateFinished":"2016-12-19T10:47:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26526"},{"text":"%md\n##What is the avg/min/max number of requests received for Mobile vs Desktop views?","dateUpdated":"2016-12-19T10:47:24+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144414159_654948605","id":"20161219-104654_369703510","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>What is the avg/min/max number of requests received for Mobile vs Desktop views?</h2>\n"},"dateCreated":"2016-12-19T10:46:54+0000","dateStarted":"2016-12-19T10:47:25+0000","dateFinished":"2016-12-19T10:47:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26527"},{"text":"\t\tpageviewsTimestampDF.filter(\"site = 'mobile'\").select(avg($\"requests\"), min($\"requests\"), max($\"requests\")).show()\n","dateUpdated":"2016-12-19T10:47:14+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144429492_670570068","id":"20161219-104709_1950766538","result":{"code":"SUCCESS","type":"TEXT","msg":"+------------------+-------------+-------------+\n|     avg(requests)|min(requests)|max(requests)|\n+------------------+-------------+-------------+\n|1279.3883227777778|          645|         3292|\n+------------------+-------------+-------------+\n\n"},"dateCreated":"2016-12-19T10:47:09+0000","dateStarted":"2016-12-19T10:47:14+0000","dateFinished":"2016-12-19T10:47:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26528"},{"text":"\t\tpageviewsTimestampDF.filter(\"site = 'desktop'\").select(avg($\"requests\"), min($\"requests\"), max($\"requests\")).show()\n","dateUpdated":"2016-12-19T10:47:19+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144434645_1406994787","id":"20161219-104714_1135596816","result":{"code":"SUCCESS","type":"TEXT","msg":"+------------------+-------------+-------------+\n|     avg(requests)|min(requests)|max(requests)|\n+------------------+-------------+-------------+\n|2426.9947144444445|         1312|         5695|\n+------------------+-------------+-------------+\n\n"},"dateCreated":"2016-12-19T10:47:14+0000","dateStarted":"2016-12-19T10:47:19+0000","dateFinished":"2016-12-19T10:47:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26529"},{"text":"%md\n##Which day of the week does Wikipedia gets the most traffic?","dateUpdated":"2016-12-19T10:47:39+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144439048_-1540966610","id":"20161219-104719_1704583232","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Which day of the week does Wikipedia gets the most traffic?</h2>\n"},"dateCreated":"2016-12-19T10:47:19+0000","dateStarted":"2016-12-19T10:47:39+0000","dateFinished":"2016-12-19T10:47:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26530"},{"text":"val pageviewsByDayOfWeekDF = pageviewsTimestampDF.groupBy(date_format(($\"timestamp\"), \"E\").alias(\"Day of week\")).sum()\n\t\tpageviewsByDayOfWeekDF.registerTempTable(\"pageviews_by_DOW\")\n\t\tsqlContext.cacheTable(\"pageviews_by_DOW\")\n\t\tpageviewsByDayOfWeekDF.show()","dateUpdated":"2016-12-19T10:47:57+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144459010_513253740","id":"20161219-104739_744446393","result":{"code":"SUCCESS","type":"TEXT","msg":"pageviewsByDayOfWeekDF: org.apache.spark.sql.DataFrame = [Day of week: string, sum(requests): bigint]\n+-----------+-------------+\n|Day of week|sum(requests)|\n+-----------+-------------+\n|        Tue|   1995034884|\n|        Thu|   1931508977|\n|        Sat|   1662762048|\n|        Sun|   1576726066|\n|        Fri|   1842512718|\n|        Mon|   2356818845|\n|        Wed|   1977615396|\n+-----------+-------------+\n\n"},"dateCreated":"2016-12-19T10:47:39+0000","dateStarted":"2016-12-19T10:47:57+0000","dateFinished":"2016-12-19T10:48:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26531"},{"text":"%md\n## User Defined Functions\n","dateUpdated":"2016-12-19T10:48:45+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144477420_-799109434","id":"20161219-104757_114575005","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>User Defined Functions</h2>\n"},"dateCreated":"2016-12-19T10:47:57+0000","dateStarted":"2016-12-19T10:48:45+0000","dateFinished":"2016-12-19T10:48:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26532"},{"text":"def matchDayOfWeek(day: String): String = {\n\t\t\tday match {\n\t\t\t\tcase \"Mon\" => \"1-Mon\"\n\t\t\t\tcase \"Tue\" => \"2-Tue\"\n\t\t\t\tcase \"Wed\" => \"3-Wed\"\n\t\t\t\tcase \"Thu\" => \"4-Thu\"\n\t\t\t\tcase \"Fri\" => \"5-Fri\"\n\t\t\t\tcase \"Sat\" => \"6-Sat\"\n\t\t\t\tcase \"Sun\" => \"7-Sun\"\n\t\t\t\tcase \"ma\" => \"1-Mon\"\n\t\t\t\tcase \"di\" => \"2-Tue\"\n\t\t\t\tcase \"wo\" => \"3-Wed\"\n\t\t\t\tcase \"do\" => \"4-Thu\"\n\t\t\t\tcase \"vr\" => \"5-Fri\"\n\t\t\t\tcase \"za\" => \"6-Sat\"\n\t\t\t\tcase \"zo\" => \"7-Sun\"\n\t\t\t\tcase _ => \"UNKNOWN\"\n\t\t\t}\n\t\t}","dateUpdated":"2016-12-19T10:48:53+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144525689_-470641143","id":"20161219-104845_1636576128","result":{"code":"SUCCESS","type":"TEXT","msg":"matchDayOfWeek: (day: String)String\n"},"dateCreated":"2016-12-19T10:48:45+0000","dateStarted":"2016-12-19T10:48:53+0000","dateFinished":"2016-12-19T10:48:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26533"},{"text":"\t\tmatchDayOfWeek(\"Tue\")\n","dateUpdated":"2016-12-19T10:49:03+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144533850_685929375","id":"20161219-104853_1544285784","result":{"code":"SUCCESS","type":"TEXT","msg":"res35: String = 2-Tue\n"},"dateCreated":"2016-12-19T10:48:53+0000","dateStarted":"2016-12-19T10:49:03+0000","dateFinished":"2016-12-19T10:49:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26534"},{"text":"val prependNumberUDF = sqlContext.udf.register(\"prependNumber\", (s: String) => matchDayOfWeek(s))\n\t\t","dateUpdated":"2016-12-19T10:49:19+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144543420_-1520220818","id":"20161219-104903_2076574484","result":{"code":"SUCCESS","type":"TEXT","msg":"prependNumberUDF: org.apache.spark.sql.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,List(StringType))\n"},"dateCreated":"2016-12-19T10:49:03+0000","dateStarted":"2016-12-19T10:49:19+0000","dateFinished":"2016-12-19T10:49:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26535"},{"text":"pageviewsByDayOfWeekDF.select(prependNumberUDF($\"Day of week\")).show(7)","dateUpdated":"2016-12-19T10:49:24+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144559132_-183756381","id":"20161219-104919_1159944117","result":{"code":"SUCCESS","type":"TEXT","msg":"+----------------+\n|UDF(Day of week)|\n+----------------+\n|           2-Tue|\n|           4-Thu|\n|           6-Sat|\n|           7-Sun|\n|           5-Fri|\n|           1-Mon|\n|           3-Wed|\n+----------------+\n\n"},"dateCreated":"2016-12-19T10:49:19+0000","dateStarted":"2016-12-19T10:49:24+0000","dateFinished":"2016-12-19T10:49:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26536"},{"text":"pageviewsByDayOfWeekDF.withColumnRenamed(\"sum(requests)\", \"total requests\")\n\t\t.select(prependNumberUDF($\"Day of week\"), $\"total requests\")\n\t\t.orderBy(\"UDF(Day of week)\").show()","dateUpdated":"2016-12-19T10:49:50+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144564023_-723928512","id":"20161219-104924_2055078899","result":{"code":"SUCCESS","type":"TEXT","msg":"+----------------+--------------+\n|UDF(Day of week)|total requests|\n+----------------+--------------+\n|           1-Mon|    2356818845|\n|           2-Tue|    1995034884|\n|           3-Wed|    1977615396|\n|           4-Thu|    1931508977|\n|           5-Fri|    1842512718|\n|           6-Sat|    1662762048|\n|           7-Sun|    1576726066|\n+----------------+--------------+\n\n"},"dateCreated":"2016-12-19T10:49:24+0000","dateStarted":"2016-12-19T10:49:50+0000","dateFinished":"2016-12-19T10:49:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26537"},{"text":"val mobileDF = pageviewsTimestampDF.filter(\"site = 'mobile'\")\n\t\tval groupedData = mobileDF.groupBy(date_format(($\"timestamp\"), \"E\").alias(\"Day of week\"))\n\t\tval sumDF = groupedData.sum().withColumnRenamed(\"sum(requests)\", \"total requests\")\n\t\tval selectDF = sumDF.select(prependNumberUDF($\"Day of week\"), $\"total requests\")\n\t\tval orderedDF = selectDF.orderBy(\"UDF(Day of week)\")\n\t\tval mobileViewsByDayOfWeekDF = orderedDF.toDF(\"DOW\", \"mobile_requests\")\n\t\tmobileViewsByDayOfWeekDF.cache()\n\t\tmobileViewsByDayOfWeekDF.show(truncate = false)","dateUpdated":"2016-12-19T10:50:45+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144590641_-800847644","id":"20161219-104950_53349415","result":{"code":"SUCCESS","type":"TEXT","msg":"mobileDF: org.apache.spark.sql.DataFrame = [timestamp: timestamp, site: string, requests: int]\ngroupedData: org.apache.spark.sql.GroupedData = org.apache.spark.sql.GroupedData@e51373c\nsumDF: org.apache.spark.sql.DataFrame = [Day of week: string, total requests: bigint]\nselectDF: org.apache.spark.sql.DataFrame = [UDF(Day of week): string, total requests: bigint]\norderedDF: org.apache.spark.sql.DataFrame = [UDF(Day of week): string, total requests: bigint]\nmobileViewsByDayOfWeekDF: org.apache.spark.sql.DataFrame = [DOW: string, mobile_requests: bigint]\nres42: mobileViewsByDayOfWeekDF.type = [DOW: string, mobile_requests: bigint]\n+-----+---------------+\n|DOW  |mobile_requests|\n+-----+---------------+\n|1-Mon|790026669      |\n|2-Tue|648087459      |\n|3-Wed|631284694      |\n|4-Thu|625338164      |\n|5-Fri|635169886      |\n|6-Sat|646334635      |\n|7-Sun|629556455      |\n+-----+---------------+\n\n"},"dateCreated":"2016-12-19T10:49:50+0000","dateStarted":"2016-12-19T10:50:45+0000","dateFinished":"2016-12-19T10:51:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26538"},{"text":"val desktopViewsByDayOfWeekDF = pageviewsTimestampDF\n\t\t                                .filter(\"site = 'desktop'\")\n\t\t                                .groupBy(date_format(($\"timestamp\"), \"E\").alias(\"Day of week\")).sum().withColumnRenamed(\"sum(requests)\", \"total requests\")\n\t\t                                .select(prependNumberUDF($\"Day of week\"), $\"total requests\")\n\t\t                                .orderBy(\"UDF(Day of week)\")\n\t\t                                .toDF(\"DOW\", \"desktop_requests\")\n\tdesktopViewsByDayOfWeekDF.cache()\n\t\tdesktopViewsByDayOfWeekDF.show(truncate = false)","dateUpdated":"2016-12-19T10:51:37+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144645418_1341293025","id":"20161219-105045_1128204494","result":{"code":"SUCCESS","type":"TEXT","msg":"desktopViewsByDayOfWeekDF: org.apache.spark.sql.DataFrame = [DOW: string, desktop_requests: bigint]\nres46: desktopViewsByDayOfWeekDF.type = [DOW: string, desktop_requests: bigint]\n+-----+----------------+\n|DOW  |desktop_requests|\n+-----+----------------+\n|1-Mon|1566792176      |\n|2-Tue|1346947425      |\n|3-Wed|1346330702      |\n|4-Thu|1306170813      |\n|5-Fri|1207342832      |\n|6-Sat|1016427413      |\n|7-Sun|947169611       |\n+-----+----------------+\n\n"},"dateCreated":"2016-12-19T10:50:45+0000","dateStarted":"2016-12-19T10:51:37+0000","dateFinished":"2016-12-19T10:51:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26539"},{"text":"%md\n## Join 2 dataframes together ","dateUpdated":"2016-12-19T10:52:07+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144657137_-1679370589","id":"20161219-105057_1430201891","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Join 2 dataframes together</h2>\n"},"dateCreated":"2016-12-19T10:50:57+0000","dateStarted":"2016-12-19T10:52:07+0000","dateFinished":"2016-12-19T10:52:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26540"},{"text":"val allViewsByDayOfWeekDF = mobileViewsByDayOfWeekDF\n\t\t                            .join(desktopViewsByDayOfWeekDF,\n\t\t                                  mobileViewsByDayOfWeekDF(\"DOW\") === desktopViewsByDayOfWeekDF(\"DOW\"))\n\t\t\n\t\tallViewsByDayOfWeekDF.show(truncate = false)","dateUpdated":"2016-12-19T10:52:15+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144727197_-1255838671","id":"20161219-105207_1736117766","result":{"code":"SUCCESS","type":"TEXT","msg":"allViewsByDayOfWeekDF: org.apache.spark.sql.DataFrame = [DOW: string, mobile_requests: bigint, DOW: string, desktop_requests: bigint]\n+-----+---------------+-----+----------------+\n|DOW  |mobile_requests|DOW  |desktop_requests|\n+-----+---------------+-----+----------------+\n|1-Mon|790026669      |1-Mon|1566792176      |\n|2-Tue|648087459      |2-Tue|1346947425      |\n|3-Wed|631284694      |3-Wed|1346330702      |\n|4-Thu|625338164      |4-Thu|1306170813      |\n|5-Fri|635169886      |5-Fri|1207342832      |\n|6-Sat|646334635      |6-Sat|1016427413      |\n|7-Sun|629556455      |7-Sun|947169611       |\n+-----+---------------+-----+----------------+\n\n"},"dateCreated":"2016-12-19T10:52:07+0000","dateStarted":"2016-12-19T10:52:15+0000","dateFinished":"2016-12-19T10:52:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26541"},{"text":"%md\n## Let's see what the catalyst optimizer does..","dateUpdated":"2016-12-19T10:52:36+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144735568_-83108700","id":"20161219-105215_333141120","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Let's see what the catalyst optimizer does..</h2>\n"},"dateCreated":"2016-12-19T10:52:15+0000","dateStarted":"2016-12-19T10:52:36+0000","dateFinished":"2016-12-19T10:52:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26542"},{"text":"allViewsByDayOfWeekDF.explain()","dateUpdated":"2016-12-19T10:52:49+0000","config":{"colWidth":12,"graph":{"mode":"table","height":229.40000915527344,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144756548_-1830422021","id":"20161219-105236_1154609343","result":{"code":"SUCCESS","type":"TEXT","msg":"== Physical Plan ==\nBroadcastHashJoin [DOW#250], [DOW#301], BuildRight\n:- InMemoryColumnarTableScan [DOW#250,mobile_requests#251L], InMemoryRelation [DOW#250,mobile_requests#251L], true, 10000, StorageLevel(true, true, false, true, 1), Project [UDF(Day of week)#249 AS DOW#250,total requests#248L AS mobile_requests#251L], None\n+- InMemoryColumnarTableScan [DOW#301,desktop_requests#302L], InMemoryRelation [DOW#301,desktop_requests#302L], true, 10000, StorageLevel(true, true, false, true, 1), Project [UDF(Day of week)#300 AS DOW#301,total requests#299L AS desktop_requests#302L], None\n"},"dateCreated":"2016-12-19T10:52:36+0000","dateStarted":"2016-12-19T10:52:41+0000","dateFinished":"2016-12-19T10:52:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26543"},{"text":"%md\n# Let's play little bit with SparkML","dateUpdated":"2016-12-19T10:55:44+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144761816_1691600059","id":"20161219-105241_1507981488","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Let's play little bit with SparkML</h1>\n"},"dateCreated":"2016-12-19T10:52:41+0000","dateStarted":"2016-12-19T10:55:44+0000","dateFinished":"2016-12-19T10:55:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26544"},{"text":"val wikiDF = pagecountsEnWikipediaArticlesOnlyDF.orderBy($\"requests\".desc)","dateUpdated":"2016-12-19T11:02:32+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144944335_-53976697","id":"20161219-105544_781098529","result":{"code":"SUCCESS","type":"TEXT","msg":"wikiDF: org.apache.spark.sql.DataFrame = [project: string, item: string, requests: double]\n"},"dateCreated":"2016-12-19T10:55:44+0000","dateStarted":"2016-12-19T11:02:32+0000","dateFinished":"2016-12-19T11:02:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26545"},{"text":"wikiDF.columns","dateUpdated":"2016-12-19T10:56:19+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144966376_1197272699","id":"20161219-105606_1040655786","result":{"code":"SUCCESS","type":"TEXT","msg":"res63: Array[String] = Array(project, item, requests)\n"},"dateCreated":"2016-12-19T10:56:06+0000","dateStarted":"2016-12-19T10:56:19+0000","dateFinished":"2016-12-19T10:56:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26546"},{"text":"wikiDF.cache","dateUpdated":"2016-12-19T11:02:40+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144979275_1062225835","id":"20161219-105619_117722107","result":{"code":"SUCCESS","type":"TEXT","msg":"res84: wikiDF.type = [project: string, item: string, requests: double]\n"},"dateCreated":"2016-12-19T10:56:19+0000","dateStarted":"2016-12-19T11:02:40+0000","dateFinished":"2016-12-19T11:02:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26547"},{"text":"wikiDF.show(5)","dateUpdated":"2016-12-19T11:02:47+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482144998986_1438556232","id":"20161219-105638_1718735409","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------+--------------------+---------+\n|project|                item| requests|\n+-------+--------------------+---------+\n|     en|           Main_Page|1225357.0|\n|     en|      Antoninus_Pius|  36462.0|\n|     en|                Okto|   9495.0|\n|     en|Liberian_general_...|   9309.0|\n|     en|         Proyecto_40|   9282.0|\n+-------+--------------------+---------+\nonly showing top 5 rows\n\n"},"dateCreated":"2016-12-19T10:56:38+0000","dateStarted":"2016-12-19T11:02:47+0000","dateFinished":"2016-12-19T11:02:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26548"},{"text":"%md\n### Use lowered case data frame","dateUpdated":"2016-12-19T10:57:26+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145030996_1105610515","id":"20161219-105710_1752424250","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Use lowered case data frame</h3>\n"},"dateCreated":"2016-12-19T10:57:10+0000","dateStarted":"2016-12-19T10:57:26+0000","dateFinished":"2016-12-19T10:57:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26549"},{"text":"val wikiLoweredDF = wikiDF.select($\"*\", lower($\"item\").as(\"lowerText\"))","dateUpdated":"2016-12-19T11:03:01+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145010755_-1047490302","id":"20161219-105650_604159705","result":{"code":"SUCCESS","type":"TEXT","msg":"wikiLoweredDF: org.apache.spark.sql.DataFrame = [project: string, item: string, requests: double, lowerText: string]\n"},"dateCreated":"2016-12-19T10:56:50+0000","dateStarted":"2016-12-19T11:03:01+0000","dateFinished":"2016-12-19T11:03:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26550"},{"text":"wikiLoweredDF.show(5)","dateUpdated":"2016-12-19T11:03:06+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145052054_550433177","id":"20161219-105732_1925011054","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------+--------------------+---------+--------------------+\n|project|                item| requests|           lowerText|\n+-------+--------------------+---------+--------------------+\n|     en|           Main_Page|1225357.0|           main_page|\n|     en|      Antoninus_Pius|  36462.0|      antoninus_pius|\n|     en|                Okto|   9495.0|                okto|\n|     en|Liberian_general_...|   9309.0|liberian_general_...|\n|     en|         Proyecto_40|   9282.0|         proyecto_40|\n+-------+--------------------+---------+--------------------+\nonly showing top 5 rows\n\n"},"dateCreated":"2016-12-19T10:57:32+0000","dateStarted":"2016-12-19T11:03:06+0000","dateFinished":"2016-12-19T11:03:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26551"},{"text":"val bigitems =  wikiLoweredDF.filter($\"requests\" > 4000)\nbigitems.show(truncate=false)","dateUpdated":"2016-12-19T13:19:33+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482149464864_1845410366","id":"20161219-121104_1662222235","result":{"code":"SUCCESS","type":"TEXT","msg":"bigitems: org.apache.spark.sql.DataFrame = [project: string, item: string, requests: double, lowerText: string]\n+-------+---------------------------------+---------+---------------------------------+\n|project|item                             |requests |lowerText                        |\n+-------+---------------------------------+---------+---------------------------------+\n|en     |Main_Page                        |1225357.0|main_page                        |\n|en     |Antoninus_Pius                   |36462.0  |antoninus_pius                   |\n|en     |Okto                             |9495.0   |okto                             |\n|en     |Liberian_general_election,_1927  |9309.0   |liberian_general_election,_1927  |\n|en     |Proyecto_40                      |9282.0   |proyecto_40                      |\n|en     |Jimmy_Walker_(golfer)            |8144.0   |jimmy_walker_(golfer)            |\n|en     |Harry_Potter_and_the_Cursed_Child|5536.0   |harry_potter_and_the_cursed_child|\n|en     |RAS_syndrome                     |5267.0   |ras_syndrome                     |\n+-------+---------------------------------+---------+---------------------------------+\n\n"},"dateCreated":"2016-12-19T12:11:04+0000","dateStarted":"2016-12-19T13:19:34+0000","dateFinished":"2016-12-19T13:19:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26552"},{"text":"%md\nSetup the SparkML pipeline","dateUpdated":"2016-12-19T10:58:43+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145088458_-550071271","id":"20161219-105808_2008690697","result":{"code":"SUCCESS","type":"HTML","msg":"<p>Setup the SparkML pipeline</p>\n"},"dateCreated":"2016-12-19T10:58:08+0000","dateStarted":"2016-12-19T10:58:43+0000","dateFinished":"2016-12-19T10:58:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26553"},{"text":"import org.apache.spark.ml.feature.{RegexTokenizer, StopWordsRemover, HashingTF, IDF, Normalizer}","dateUpdated":"2016-12-19T10:58:46+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145123414_178304369","id":"20161219-105843_656067242","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.ml.feature.{RegexTokenizer, StopWordsRemover, HashingTF, IDF, Normalizer}\n"},"dateCreated":"2016-12-19T10:58:43+0000","dateStarted":"2016-12-19T10:58:46+0000","dateFinished":"2016-12-19T10:58:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26554"},{"text":"%md\n## Step 1: Natural Language Processing: RegexTokenizer: Convert the lowerText col to a bag of words","dateUpdated":"2016-12-19T10:59:16+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145126734_-2057486813","id":"20161219-105846_427273313","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Step 1: Natural Language Processing: RegexTokenizer: Convert the lowerText col to a bag of words</h2>\n"},"dateCreated":"2016-12-19T10:58:46+0000","dateStarted":"2016-12-19T10:59:16+0000","dateFinished":"2016-12-19T10:59:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26555"},{"text":"val tokenizer = new RegexTokenizer()\n  .setInputCol(\"lowerText\")\n  .setOutputCol(\"words\")\n  .setPattern(\"\\\\W+\")","dateUpdated":"2016-12-19T13:19:48+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145150073_-879957609","id":"20161219-105910_1522917081","result":{"code":"SUCCESS","type":"TEXT","msg":"tokenizer: org.apache.spark.ml.feature.RegexTokenizer = regexTok_2538b4b326bc\n"},"dateCreated":"2016-12-19T10:59:10+0000","dateStarted":"2016-12-19T13:19:48+0000","dateFinished":"2016-12-19T13:19:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26556"},{"text":"val wikiWordsDF = tokenizer.transform(bigitems)","dateUpdated":"2016-12-19T13:19:56+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145172555_1768315043","id":"20161219-105932_486880600","result":{"code":"SUCCESS","type":"TEXT","msg":"wikiWordsDF: org.apache.spark.sql.DataFrame = [project: string, item: string, requests: double, lowerText: string, words: array<string>]\n"},"dateCreated":"2016-12-19T10:59:32+0000","dateStarted":"2016-12-19T13:19:56+0000","dateFinished":"2016-12-19T13:19:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26557"},{"text":"wikiWordsDF.printSchema","dateUpdated":"2016-12-19T13:20:05+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145189164_-131559702","id":"20161219-105949_923607381","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- project: string (nullable = true)\n |-- item: string (nullable = true)\n |-- requests: double (nullable = true)\n |-- lowerText: string (nullable = true)\n |-- words: array (nullable = true)\n |    |-- element: string (containsNull = true)\n\n"},"dateCreated":"2016-12-19T10:59:49+0000","dateStarted":"2016-12-19T13:20:05+0000","dateFinished":"2016-12-19T13:20:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26558"},{"text":"wikiWordsDF.select(\"words\").show(20)","dateUpdated":"2016-12-19T12:14:37+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145203023_441947667","id":"20161219-110003_342424267","result":{"code":"SUCCESS","type":"TEXT","msg":"+--------------------+\n|               words|\n+--------------------+\n|         [main_page]|\n|    [antoninus_pius]|\n|              [okto]|\n|[liberian_general...|\n|       [proyecto_40]|\n|[jimmy_walker_, g...|\n|[harry_potter_and...|\n|      [ras_syndrome]|\n|[list_of_feed_agg...|\n|         [jason_day]|\n|[stranger_things_...|\n|            [dating]|\n|[lali_esp, c3, b3...|\n|      [donald_trump]|\n|    [deaths_in_2016]|\n|[suicide_squad_, ...|\n|[jason_bourne_, f...|\n|[killing_of_tim_m...|\n|[2016_summer_olym...|\n|               [ddd]|\n+--------------------+\nonly showing top 20 rows\n\n"},"dateCreated":"2016-12-19T11:00:03+0000","dateStarted":"2016-12-19T12:14:37+0000","dateFinished":"2016-12-19T12:14:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26559"},{"text":"%md\n## Step 2: Natural Language Processing: StopWordsRemover: Remove Stop words","dateUpdated":"2016-12-19T11:04:15+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145220971_-592626802","id":"20161219-110020_2003384626","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Step 2: Natural Language Processing: StopWordsRemover: Remove Stop words</h2>\n"},"dateCreated":"2016-12-19T11:00:20+0000","dateStarted":"2016-12-19T11:04:15+0000","dateFinished":"2016-12-19T11:04:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26560"},{"text":"val remover = new StopWordsRemover()\n  .setInputCol(\"words\")\n  .setOutputCol(\"noStopWords\")","dateUpdated":"2016-12-19T13:20:16+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145455380_-32523824","id":"20161219-110415_623476932","result":{"code":"SUCCESS","type":"TEXT","msg":"remover: org.apache.spark.ml.feature.StopWordsRemover = stopWords_1adce646b071\n"},"dateCreated":"2016-12-19T11:04:15+0000","dateStarted":"2016-12-19T13:20:16+0000","dateFinished":"2016-12-19T13:20:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26561"},{"text":"val noStopWordsListDF = remover.transform(wikiWordsDF)","dateUpdated":"2016-12-19T13:20:23+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145506426_64340953","id":"20161219-110506_1022204093","result":{"code":"SUCCESS","type":"TEXT","msg":"noStopWordsListDF: org.apache.spark.sql.DataFrame = [project: string, item: string, requests: double, lowerText: string, words: array<string>, noStopWords: array<string>]\n"},"dateCreated":"2016-12-19T11:05:06+0000","dateStarted":"2016-12-19T13:20:24+0000","dateFinished":"2016-12-19T13:20:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26562"},{"text":"noStopWordsListDF.printSchema","dateUpdated":"2016-12-19T11:05:30+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145519753_-250768396","id":"20161219-110519_106704232","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- project: string (nullable = true)\n |-- item: string (nullable = true)\n |-- requests: double (nullable = true)\n |-- lowerText: string (nullable = true)\n |-- words: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- noStopWords: array (nullable = true)\n |    |-- element: string (containsNull = true)\n\n"},"dateCreated":"2016-12-19T11:05:19+0000","dateStarted":"2016-12-19T11:05:30+0000","dateFinished":"2016-12-19T11:05:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26563"},{"text":"noStopWordsListDF.select(\"project\", \"item\", \"words\", \"noStopWords\").show(15)","dateUpdated":"2016-12-19T11:06:03+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145530679_-1589847810","id":"20161219-110530_1964454362","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------+--------------------+--------------------+--------------------+\n|project|                item|               words|         noStopWords|\n+-------+--------------------+--------------------+--------------------+\n|     en|           Main_Page|         [main_page]|         [main_page]|\n|     en|      Antoninus_Pius|    [antoninus_pius]|    [antoninus_pius]|\n|     en|                Okto|              [okto]|              [okto]|\n|     en|Liberian_general_...|[liberian_general...|[liberian_general...|\n|     en|         Proyecto_40|       [proyecto_40]|       [proyecto_40]|\n|     en|Jimmy_Walker_(gol...|[jimmy_walker_, g...|[jimmy_walker_, g...|\n|     en|Harry_Potter_and_...|[harry_potter_and...|[harry_potter_and...|\n|     en|        RAS_syndrome|      [ras_syndrome]|      [ras_syndrome]|\n|     en|List_of_feed_aggr...|[list_of_feed_agg...|[list_of_feed_agg...|\n|     en|           Jason_Day|         [jason_day]|         [jason_day]|\n|     en|Stranger_Things_(...|[stranger_things_...|[stranger_things_...|\n|     en|              Dating|            [dating]|            [dating]|\n|     en|  Lali_Esp%C3%B3sito|[lali_esp, c3, b3...|[lali_esp, c3, b3...|\n|     en|        Donald_Trump|      [donald_trump]|      [donald_trump]|\n|     en|      Deaths_in_2016|    [deaths_in_2016]|    [deaths_in_2016]|\n+-------+--------------------+--------------------+--------------------+\nonly showing top 15 rows\n\n"},"dateCreated":"2016-12-19T11:05:30+0000","dateStarted":"2016-12-19T11:06:04+0000","dateFinished":"2016-12-19T11:06:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26564"},{"text":"%md\n## Hashing TF","dateUpdated":"2016-12-19T11:10:22+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145542321_1277701067","id":"20161219-110542_466434899","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Hashing TF</h2>\n"},"dateCreated":"2016-12-19T11:05:42+0000","dateStarted":"2016-12-19T11:10:22+0000","dateFinished":"2016-12-19T11:10:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26565"},{"text":"val hashingTF = new HashingTF().setInputCol(\"noStopWords\").setOutputCol(\"hashingTF\").setNumFeatures(20000)\nval featurizedDataDF = hashingTF.transform(noStopWordsListDF)","dateUpdated":"2016-12-19T13:20:39+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145588469_1845282315","id":"20161219-110628_1365713276","result":{"code":"SUCCESS","type":"TEXT","msg":"hashingTF: org.apache.spark.ml.feature.HashingTF = hashingTF_0c8c0ef15002\nfeaturizedDataDF: org.apache.spark.sql.DataFrame = [project: string, item: string, requests: double, lowerText: string, words: array<string>, noStopWords: array<string>, hashingTF: vector]\n"},"dateCreated":"2016-12-19T11:06:28+0000","dateStarted":"2016-12-19T13:20:39+0000","dateFinished":"2016-12-19T13:20:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26566"},{"text":"featurizedDataDF.printSchema","dateUpdated":"2016-12-19T11:07:22+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145599800_-373748482","id":"20161219-110639_903337572","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- project: string (nullable = true)\n |-- item: string (nullable = true)\n |-- requests: double (nullable = true)\n |-- lowerText: string (nullable = true)\n |-- words: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- noStopWords: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- hashingTF: vector (nullable = true)\n\n"},"dateCreated":"2016-12-19T11:06:39+0000","dateStarted":"2016-12-19T11:07:22+0000","dateFinished":"2016-12-19T11:07:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26567"},{"text":"featurizedDataDF.select(\"project\", \"item\", \"noStopWords\", \"hashingTF\").show(7)","dateUpdated":"2016-12-19T11:09:44+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145652720_-1880363878","id":"20161219-110732_1391336909","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------+--------------------+--------------------+--------------------+\n|project|                item|         noStopWords|           hashingTF|\n+-------+--------------------+--------------------+--------------------+\n|     en|           Main_Page|         [main_page]|(20000,[10005],[1...|\n|     en|      Antoninus_Pius|    [antoninus_pius]|(20000,[15053],[1...|\n|     en|                Okto|              [okto]|(20000,[13335],[1...|\n|     en|Liberian_general_...|[liberian_general...|(20000,[10636,179...|\n|     en|         Proyecto_40|       [proyecto_40]|(20000,[3574],[1.0])|\n|     en|Jimmy_Walker_(gol...|[jimmy_walker_, g...|(20000,[4783,9092...|\n|     en|Harry_Potter_and_...|[harry_potter_and...|(20000,[4985],[1.0])|\n+-------+--------------------+--------------------+--------------------+\nonly showing top 7 rows\n\n"},"dateCreated":"2016-12-19T11:07:32+0000","dateStarted":"2016-12-19T11:09:44+0000","dateFinished":"2016-12-19T11:09:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26568"},{"text":"%md\n## Step 4: IDF","dateUpdated":"2016-12-19T11:10:07+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145784366_489102095","id":"20161219-110944_1566011232","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Step 4: IDF</h2>\n"},"dateCreated":"2016-12-19T11:09:44+0000","dateStarted":"2016-12-19T11:10:07+0000","dateFinished":"2016-12-19T11:10:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26569"},{"text":"// This will take 3 - 4 mins to run\nval idf = new IDF().setInputCol(\"hashingTF\").setOutputCol(\"idf\")\nval idfModel = idf.fit(featurizedDataDF)","dateUpdated":"2016-12-19T13:20:56+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145807801_-308266192","id":"20161219-111007_198617824","result":{"code":"SUCCESS","type":"TEXT","msg":"idf: org.apache.spark.ml.feature.IDF = idf_5ac41510d0ee\nidfModel: org.apache.spark.ml.feature.IDFModel = idf_5ac41510d0ee\n"},"dateCreated":"2016-12-19T11:10:07+0000","dateStarted":"2016-12-19T13:20:56+0000","dateFinished":"2016-12-19T13:20:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26570"},{"text":"%md\n## Step 5: Normalizer","dateUpdated":"2016-12-19T11:11:00+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145840873_-357083330","id":"20161219-111040_4692004","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Step 5: Normalizer</h2>\n"},"dateCreated":"2016-12-19T11:10:40+0000","dateStarted":"2016-12-19T11:11:00+0000","dateFinished":"2016-12-19T11:11:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26571"},{"text":"// A normalizer is a common operation for text classification.\n\n// It simply gets all of the data on the same scale... for example, if one article is much longer and another, it'll normalize the scales for the different features.\n\n// If we don't normalize, an article with more words would be weighted differently\n\nval normalizer = new Normalizer()\n  .setInputCol(\"idf\")\n  .setOutputCol(\"features\")","dateUpdated":"2016-12-19T13:21:11+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145860192_734696131","id":"20161219-111100_182640624","result":{"code":"SUCCESS","type":"TEXT","msg":"normalizer: org.apache.spark.ml.feature.Normalizer = normalizer_863de1d5711a\n"},"dateCreated":"2016-12-19T11:11:00+0000","dateStarted":"2016-12-19T13:21:11+0000","dateFinished":"2016-12-19T13:21:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26572"},{"text":"%md\n## K-means and summing it all up","dateUpdated":"2016-12-19T11:12:22+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145918174_13368564","id":"20161219-111158_1691252362","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>K-means and summing it all up</h2>\n"},"dateCreated":"2016-12-19T11:11:58+0000","dateStarted":"2016-12-19T11:12:22+0000","dateFinished":"2016-12-19T11:12:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26573"},{"text":"%md\n## ATTENTION: The below block will take more than 1 hour, run it once.. or load the model saved on github instead","dateUpdated":"2016-12-19T11:20:47+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482146407257_-661191492","id":"20161219-112007_1135694725","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>ATTENTION: The below block will take more than 1 hour, run it once.. or load the model saved on github instead</h2>\n"},"dateCreated":"2016-12-19T11:20:07+0000","dateStarted":"2016-12-19T11:20:47+0000","dateFinished":"2016-12-19T11:20:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26574"},{"text":"// This will take over 1 hour to run!\n\n// COMMENT THIS\n\nimport org.apache.spark.ml.Pipeline\nimport org.apache.spark.ml.clustering.KMeans\n \nval kmeans = new KMeans()\n  .setFeaturesCol(\"features\")\n  .setPredictionCol(\"prediction\")\n  .setK(100)\n  .setSeed(0) // for reproducability\n \nval pipeline = new Pipeline()\n  .setStages(Array(tokenizer, remover, hashingTF, idf, normalizer, kmeans))  \n \n","dateUpdated":"2016-12-19T13:21:28+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145942651_-1878259532","id":"20161219-111222_933443296","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.ml.Pipeline\nimport org.apache.spark.ml.clustering.KMeans\nkmeans: org.apache.spark.ml.clustering.KMeans = kmeans_ab7aed36acf8\npipeline: org.apache.spark.ml.Pipeline = pipeline_701d86f0e9cb\n"},"dateCreated":"2016-12-19T11:12:22+0000","dateStarted":"2016-12-19T13:21:28+0000","dateFinished":"2016-12-19T13:21:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26575"},{"text":"// COMMENT THIS\nval model = pipeline.fit(wikiLoweredDF)\n","dateUpdated":"2016-12-19T13:21:37+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482152831113_-159616026","id":"20161219-130711_1184008097","result":{"code":"SUCCESS","type":"TEXT","msg":"model: org.apache.spark.ml.PipelineModel = pipeline_701d86f0e9cb\n"},"dateCreated":"2016-12-19T13:07:11+0000","dateStarted":"2016-12-19T13:21:37+0000","dateFinished":"2016-12-19T14:11:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26576"},{"text":"// COMMENT THIS\nmodel.save(\"/wikipedia_pagecounts_single/fittedModel2\")","dateUpdated":"2016-12-19T14:16:27+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482152901336_646340975","id":"20161219-130821_651290496","result":{"code":"ERROR","type":"TEXT","msg":"java.lang.OutOfMemoryError: Java heap space\n\n"},"dateCreated":"2016-12-19T13:08:21+0000","dateStarted":"2016-12-19T14:16:28+0000","dateFinished":"2016-12-19T14:16:44+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:26577"},{"text":"val model2 = org.apache.spark.ml.PipelineModel.load(\"hdfs:///wikipedia_pagecounts_single/fittedModel3\")","dateUpdated":"2016-12-19T19:13:02+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482145996650_1047263835","id":"20161219-111316_273070137","dateCreated":"2016-12-19T11:13:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26578","dateFinished":"2016-12-19T19:13:08+0000","dateStarted":"2016-12-19T19:13:04+0000","result":{"code":"SUCCESS","type":"TEXT","msg":"model2: org.apache.spark.ml.PipelineModel = pipeline_e9a110c66017\n"},"focus":true},{"text":"%md\n## Let's see sample of the data and if we can see any patterns","dateUpdated":"2016-12-19T11:22:47+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482146512598_552023602","id":"20161219-112152_1732186519","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Let's see sample of the data and if we can see any patterns</h2>\n"},"dateCreated":"2016-12-19T11:21:52+0000","dateStarted":"2016-12-19T11:22:47+0000","dateFinished":"2016-12-19T11:22:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26579"},{"text":"val rawPredictionsDF = model2.transform(wikiLoweredDF)","dateUpdated":"2016-12-19T19:13:18+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482146567176_-1770043279","id":"20161219-112247_730274385","dateCreated":"2016-12-19T11:22:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26580","dateFinished":"2016-12-19T19:13:20+0000","dateStarted":"2016-12-19T19:13:19+0000","result":{"code":"SUCCESS","type":"TEXT","msg":"rawPredictionsDF: org.apache.spark.sql.DataFrame = [project: string, item: string, requests: double, lowerText: string, words: array<string>, noStopWords: array<string>, hashingTF: vector, idf: vector, features: vector, prediction: int]\n"},"focus":true},{"text":"rawPredictionsDF.columns","dateUpdated":"2016-12-19T19:13:28+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482146573118_-1126343045","id":"20161219-112253_789566008","dateCreated":"2016-12-19T11:22:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26581","dateFinished":"2016-12-19T19:13:29+0000","dateStarted":"2016-12-19T19:13:29+0000","result":{"code":"SUCCESS","type":"TEXT","msg":"res186: Array[String] = Array(project, item, requests, lowerText, words, noStopWords, hashingTF, idf, features, prediction)\n"},"focus":true},{"text":"rawPredictionsDF.show(10)","dateUpdated":"2016-12-19T19:13:38+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482146605709_-2002938957","id":"20161219-112325_1249877613","dateCreated":"2016-12-19T11:23:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26582","dateFinished":"2016-12-19T19:13:41+0000","dateStarted":"2016-12-19T19:13:39+0000","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------+--------------------+---------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+----------+\n|project|                item| requests|           lowerText|               words|         noStopWords|           hashingTF|                 idf|            features|prediction|\n+-------+--------------------+---------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+----------+\n|     en|           Main_Page|1225357.0|           main_page|         [main_page]|         [main_page]|    (5000,[5],[1.0])|(5000,[5],[7.8964...|    (5000,[5],[1.0])|         9|\n|     en|      Antoninus_Pius|  36462.0|      antoninus_pius|    [antoninus_pius]|    [antoninus_pius]|   (5000,[53],[1.0])|(5000,[53],[7.070...|   (5000,[53],[1.0])|         9|\n|     en|                Okto|   9495.0|                okto|              [okto]|              [okto]| (5000,[3335],[1.0])|(5000,[3335],[7.9...| (5000,[3335],[1.0])|         9|\n|     en|Liberian_general_...|   9309.0|liberian_general_...|[liberian_general...|[liberian_general...|(5000,[636,2931],...|(5000,[636,2931],...|(5000,[636,2931],...|         9|\n|     en|         Proyecto_40|   9282.0|         proyecto_40|       [proyecto_40]|       [proyecto_40]| (5000,[3574],[1.0])|(5000,[3574],[8.1...| (5000,[3574],[1.0])|         9|\n|     en|Jimmy_Walker_(gol...|   8144.0|jimmy_walker_(gol...|[jimmy_walker_, g...|[jimmy_walker_, g...|(5000,[4092,4783]...|(5000,[4092,4783]...|(5000,[4092,4783]...|         9|\n|     en|Harry_Potter_and_...|   5536.0|harry_potter_and_...|[harry_potter_and...|[harry_potter_and...| (5000,[4985],[1.0])|(5000,[4985],[8.3...| (5000,[4985],[1.0])|         9|\n|     en|        RAS_syndrome|   5267.0|        ras_syndrome|      [ras_syndrome]|      [ras_syndrome]| (5000,[3004],[1.0])|(5000,[3004],[8.1...| (5000,[3004],[1.0])|         9|\n|     en|List_of_feed_aggr...|   3884.0|list_of_feed_aggr...|[list_of_feed_agg...|[list_of_feed_agg...| (5000,[4920],[1.0])|(5000,[4920],[8.5...| (5000,[4920],[1.0])|         9|\n|     en|           Jason_Day|   3721.0|           jason_day|         [jason_day]|         [jason_day]| (5000,[1552],[1.0])|(5000,[1552],[8.2...| (5000,[1552],[1.0])|         9|\n+-------+--------------------+---------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+----------+\nonly showing top 10 rows\n\n"},"focus":true},{"text":"val predictionsDF = rawPredictionsDF.select($\"item\", $\"prediction\").cache","dateUpdated":"2016-12-19T19:13:56+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482146632259_2145854405","id":"20161219-112352_66962043","dateCreated":"2016-12-19T11:23:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26583","dateFinished":"2016-12-19T19:13:57+0000","dateStarted":"2016-12-19T19:13:56+0000","result":{"code":"SUCCESS","type":"TEXT","msg":"predictionsDF: org.apache.spark.sql.DataFrame = [item: string, prediction: int]\n"},"focus":true},{"text":"predictionsDF.show(10)","dateUpdated":"2016-12-19T19:14:34+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482146651223_-377112699","id":"20161219-112411_637002830","dateCreated":"2016-12-19T11:24:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26584","dateFinished":"2016-12-19T19:14:47+0000","dateStarted":"2016-12-19T19:14:34+0000","result":{"code":"SUCCESS","type":"TEXT","msg":"+--------------------+----------+\n|                item|prediction|\n+--------------------+----------+\n|           Main_Page|         9|\n|      Antoninus_Pius|         9|\n|                Okto|         9|\n|Liberian_general_...|         9|\n|         Proyecto_40|         9|\n|Jimmy_Walker_(gol...|         9|\n|Harry_Potter_and_...|         9|\n|        RAS_syndrome|         9|\n|List_of_feed_aggr...|         9|\n|           Jason_Day|         9|\n+--------------------+----------+\nonly showing top 10 rows\n\n"},"focus":true},{"text":"predictionsDF.groupBy(\"prediction\").count().orderBy($\"count\" desc).show(100)","dateUpdated":"2016-12-19T19:15:01+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482146656150_-834179068","id":"20161219-112416_743336181","dateCreated":"2016-12-19T11:24:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26585","dateFinished":"2016-12-19T19:44:05+0000","dateStarted":"2016-12-19T19:15:01+0000","result":{"code":"SUCCESS","type":"TEXT","msg":"warning: there were 1 feature warning(s); re-run with -feature for details\n+----------+-------+\n|prediction|  count|\n+----------+-------+\n|         9|1476655|\n|        68|  59727|\n|        73|  43707|\n|        38|  22614|\n|        13|   9345|\n|        70|   8270|\n|        22|   7916|\n|        80|   7562|\n|        99|   5834|\n|        44|   5794|\n|        10|   5474|\n|        17|   4786|\n|        20|   4703|\n|         0|   3879|\n|        82|   3845|\n|        63|   3812|\n|        96|   3458|\n|        64|   3358|\n|        62|   2730|\n|         5|   2567|\n|        47|   2378|\n|        74|   2180|\n|        11|   1596|\n|         4|   1549|\n|        29|   1521|\n|        88|   1489|\n|        58|   1449|\n|        57|   1368|\n|         7|   1333|\n|        31|   1307|\n|        35|   1173|\n|        54|   1146|\n|        76|   1110|\n|        45|   1098|\n|        19|   1071|\n|        30|   1060|\n|         8|   1051|\n|        67|   1010|\n|        51|    995|\n|        56|    986|\n|        23|    980|\n|         1|    963|\n|        98|    922|\n|         2|    913|\n|        55|    906|\n|        21|    887|\n|        95|    873|\n|        18|    866|\n|        90|    862|\n|        78|    852|\n|        12|    844|\n|        71|    829|\n|        14|    814|\n|        34|    813|\n|        46|    812|\n|        37|    789|\n|        27|    779|\n|        53|    778|\n|        41|    767|\n|        39|    725|\n|        89|    670|\n|        94|    648|\n|        97|    643|\n|        84|    643|\n|        92|    632|\n|        50|    615|\n|        65|    607|\n|        75|    587|\n|        42|    584|\n|        81|    571|\n|        43|    570|\n|        85|    550|\n|        77|    538|\n|        83|    512|\n|        40|    506|\n|        91|    478|\n|        33|    478|\n|        28|    462|\n|        66|    458|\n|        24|    457|\n|        59|    450|\n|        49|    446|\n|        32|    446|\n|        48|    428|\n|        72|    426|\n|        69|    414|\n|        60|    412|\n|        61|    409|\n|        36|    408|\n|        16|    402|\n|        26|    399|\n|        87|    391|\n|        86|    388|\n|        25|    377|\n|        79|    376|\n|        15|    363|\n|         3|    360|\n|        52|    337|\n|        93|    326|\n|         6|    223|\n+----------+-------+\n\n"},"focus":true},{"text":"predictionsDF.filter(\"prediction = 5\").show(25,truncate=false)","dateUpdated":"2016-12-19T19:53:36+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482146685871_-972642700","id":"20161219-112445_70556465","dateCreated":"2016-12-19T11:24:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26587","dateFinished":"2016-12-19T19:53:37+0000","dateStarted":"2016-12-19T19:53:37+0000","result":{"code":"SUCCESS","type":"TEXT","msg":"+----------------------------------+----------+\n|item                              |prediction|\n+----------------------------------+----------+\n|WWE                               |5         |\n|My_Big_Fat_Greek_Wedding_2        |5         |\n|Sophia_Loren                      |5         |\n|Vladimir_Komarov                  |5         |\n|Application_programming_interface |5         |\n|FIFA_World_Cup                    |5         |\n|New_Entrepreneurs_Foundation      |5         |\n|Common_(rapper)                   |5         |\n|Robbie_Coltrane                   |5         |\n|List_of_Internet_top-level_domains|5         |\n|Seychelles                        |5         |\n|Rebecca_Romijn                    |5         |\n|10_Things_I_Hate_About_You        |5         |\n|Blue_%C3%96yster_Cult             |5         |\n|Angkor_Wat                        |5         |\n|Eurythmics                        |5         |\n|Sam_Cooke                         |5         |\n|2002_FIFA_World_Cup               |5         |\n|Suleiman_the_Magnificent          |5         |\n|Johanna_Braddy                    |5         |\n|Scarface_(1983_film)              |5         |\n|House_of_Lies                     |5         |\n|Pornographic_film_actor           |5         |\n|North_American_Soccer_League      |5         |\n|Die_Hard_(film_series)            |5         |\n+----------------------------------+----------+\nonly showing top 25 rows\n\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482177216995_1743059762","id":"20161219-195336_1782296244","dateCreated":"2016-12-19T19:53:36+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:33573"}],"name":"Wikipedia Lab","id":"2C5GSDQ9Y","angularObjects":{"2BYG9GAN3:shared_process":[],"2C139U1BG:shared_process":[],"2BYWWZJPK:shared_process":[],"2C2VAKPN2:shared_process":[],"2BZC2RPUW:shared_process":[],"2BZQEH9EH:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}